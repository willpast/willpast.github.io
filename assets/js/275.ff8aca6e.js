(window.webpackJsonp=window.webpackJsonp||[]).push([[275],{606:function(a,s,t){"use strict";t.r(s);var n=t(4),e=Object(n.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("h1",{attrs:{id:"es详解-安装-elasticsearch和kibana安装"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#es详解-安装-elasticsearch和kibana安装"}},[a._v("#")]),a._v(" ES详解 - 安装：ElasticSearch和Kibana安装")]),a._v(" "),s("blockquote",[s("p",[a._v("了解完ElasticSearch基础和Elastic\nStack生态后，我们便可以开始学习使用ElastiSearch了。所以本文主要介绍ElasticSearch和Kibana的安装。")])]),a._v(" "),s("h2",{attrs:{id:"官网相关教程"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#官网相关教程"}},[a._v("#")]),a._v(" 官网相关教程")]),a._v(" "),s("blockquote",[s("p",[a._v("安装ElasticSearch还是先要看下官方网站。")])]),a._v(" "),s("ul",[s("li",[s("p",[s("a",{attrs:{href:"https://www.elastic.co/cn/",target:"_blank",rel:"noopener noreferrer"}},[a._v("官方网站在新窗口打开"),s("OutboundLink")],1)])]),a._v(" "),s("li",[s("p",[s("a",{attrs:{href:"https://www.elastic.co/guide/cn/elasticsearch/guide/current/running-elasticsearch.html",target:"_blank",rel:"noopener noreferrer"}},[a._v("官方2.x中文教程中安装教程在新窗口打开"),s("OutboundLink")],1)])]),a._v(" "),s("li",[s("p",[s("a",{attrs:{href:"https://www.elastic.co/cn/downloads/elasticsearch",target:"_blank",rel:"noopener noreferrer"}},[a._v("官方ElasticSearch下载地址在新窗口打开"),s("OutboundLink")],1)])]),a._v(" "),s("li",[s("p",[s("a",{attrs:{href:"https://www.elastic.co/cn/downloads/kibana",target:"_blank",rel:"noopener noreferrer"}},[a._v("官方Kibana下载地址在新窗口打开"),s("OutboundLink")],1)])])]),a._v(" "),s("p",[a._v("本系列教程基于ElasticSearch 7.x版本。")]),a._v(" "),s("h2",{attrs:{id:"安装elasticsearch"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装elasticsearch"}},[a._v("#")]),a._v(" 安装ElasticSearch")]),a._v(" "),s("blockquote",[s("p",[a._v("ElasticSearch 是基于Java平台的，所以先要安装Java")])]),a._v(" "),s("ul",[s("li",[s("strong",[a._v("平台确认")])])]),a._v(" "),s("p",[a._v("这里我准备了一台Centos7虚拟机, 为方便选择后续安装的版本，所以需要看下系统版本信息。")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root-centos ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# uname -a")]),a._v("\nLinux pdai-centos "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3.10")]),a._v(".0-862.el7.x86_64 "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#1 SMP Fri Apr 20 16:44:24 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("ul",[s("li",[s("strong",[a._v("安装Java")])])]),a._v(" "),s("p",[a._v("安装 Elasticsearch 之前，你需要先安装一个较新的版本的 Java，最好的选择是，你可以从\n"),s("a",{attrs:{href:"http://www.java.com",target:"_blank",rel:"noopener noreferrer"}},[a._v("www.java.com在新窗口打开"),s("OutboundLink")],1),a._v(" 获得官方提供的最新版本的 Java。安装以后，确认是否安装成功：")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root-centos ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# java --version")]),a._v("\nopenjdk "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("14.0")]),a._v(".2 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2020")]),a._v("-07-14\nOpenJDK Runtime Environment "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("20.3")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("slowdebug build "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("14.0")]),a._v(".2+12"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nOpenJDK "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("64")]),a._v("-Bit Server VM "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("20.3")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("slowdebug build "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("14.0")]),a._v(".2+12, mixed mode, sharing"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("ul",[s("li",[s("strong",[a._v("下载ElasticSearch")])])]),a._v(" "),s("p",[a._v("从"),s("a",{attrs:{href:"https://www.elastic.co/cn/downloads/elasticsearch",target:"_blank",rel:"noopener noreferrer"}},[a._v("这里在新窗口打开"),s("OutboundLink")],1),a._v("下载ElasticSearch")]),a._v(" "),s("p",[a._v("比如可以通过curl下载")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root-centos opt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# curl -O https://artifacts.elastic.co/downloads/elasticsearch/elasticsearch-7.12.0-linux-x86_64.tar.gz")]),a._v("\n  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current\n                                 Dload  Upload   Total   Spent    Left  Speed\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("ul",[s("li",[s("strong",[a._v("解压")])])]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root-centos opt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# tar zxvf /opt/elasticsearch-7.12.0-linux-x86_64.tar.gz ")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root-centos opt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ll | grep elasticsearch")]),a._v("\ndrwxr-xr-x  "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("9")]),a._v(" root root      "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4096")]),a._v(" Mar "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("18")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("14")]),a._v(":21 elasticsearch-7.12.0\n-rw-r--r--  "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v(" root root "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("327497331")]),a._v(" Apr  "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("21")]),a._v(":05 elasticsearch-7.12.0-linux-x86_64.tar.gz\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])]),s("ul",[s("li",[s("strong",[a._v("增加elasticSearch用户")])])]),a._v(" "),s("p",[a._v("必须创建一个非root用户来运行ElasticSearch(ElasticSearch5及以上版本，基于安全考虑，强制规定不能以root身份运行。)")]),a._v(" "),s("p",[a._v("如果你使用root用户来启动ElasticSearch，则会有如下错误信息：")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root-centos opt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# cd elasticsearch-7.12.0/")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root-centos elasticsearch-7.12.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ./bin/elasticsearch")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2021")]),a._v("-04-05T21:36:46,510"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("ERROR"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("o.e.b.ElasticsearchUncaughtExceptionHandler"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("pdai-centos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" uncaught exception "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" thread "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\norg.elasticsearch.bootstrap.StartupException: java.lang.RuntimeException: can not run elasticsearch as root\n        at org.elasticsearch.bootstrap.Elasticsearch.init"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("Elasticsearch.java:163"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("elasticsearch-7.12.0.jar:7.12.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n        at org.elasticsearch.bootstrap.Elasticsearch.execute"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("Elasticsearch.java:150"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("elasticsearch-7.12.0.jar:7.12.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n        at org.elasticsearch.cli.EnvironmentAwareCommand.execute"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("EnvironmentAwareCommand.java:75"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("elasticsearch-7.12.0.jar:7.12.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n        at org.elasticsearch.cli.Command.mainWithoutErrorHandling"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("Command.java:116"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("elasticsearch-cli-7.12.0.jar:7.12.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n        at org.elasticsearch.cli.Command.main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("Command.java:79"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("elasticsearch-cli-7.12.0.jar:7.12.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n        at org.elasticsearch.bootstrap.Elasticsearch.main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("Elasticsearch.java:115"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("elasticsearch-7.12.0.jar:7.12.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n        at org.elasticsearch.bootstrap.Elasticsearch.main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("Elasticsearch.java:81"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("elasticsearch-7.12.0.jar:7.12.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\nCaused by: java.lang.RuntimeException: can not run elasticsearch as root\n        at org.elasticsearch.bootstrap.Bootstrap.initializeNatives"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("Bootstrap.java:101"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("elasticsearch-7.12.0.jar:7.12.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n        at org.elasticsearch.bootstrap.Bootstrap.setup"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("Bootstrap.java:168"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("elasticsearch-7.12.0.jar:7.12.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n        at org.elasticsearch.bootstrap.Bootstrap.init"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("Bootstrap.java:397"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("elasticsearch-7.12.0.jar:7.12.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n        at org.elasticsearch.bootstrap.Elasticsearch.init"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("Elasticsearch.java:159"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("elasticsearch-7.12.0.jar:7.12.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(". "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("6")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("more")]),a._v("\nuncaught exception "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" thread "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\njava.lang.RuntimeException: can not run elasticsearch as root\n        at org.elasticsearch.bootstrap.Bootstrap.initializeNatives"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("Bootstrap.java:101"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n        at org.elasticsearch.bootstrap.Bootstrap.setup"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("Bootstrap.java:168"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n        at org.elasticsearch.bootstrap.Bootstrap.init"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("Bootstrap.java:397"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n        at org.elasticsearch.bootstrap.Elasticsearch.init"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("Elasticsearch.java:159"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n        at org.elasticsearch.bootstrap.Elasticsearch.execute"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("Elasticsearch.java:150"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n        at org.elasticsearch.cli.EnvironmentAwareCommand.execute"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("EnvironmentAwareCommand.java:75"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n        at org.elasticsearch.cli.Command.mainWithoutErrorHandling"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("Command.java:116"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n        at org.elasticsearch.cli.Command.main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("Command.java:79"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n        at org.elasticsearch.bootstrap.Elasticsearch.main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("Elasticsearch.java:115"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\n        at org.elasticsearch.bootstrap.Elasticsearch.main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("Elasticsearch.java:81"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v("\nFor complete error details, refer to the log at /opt/elasticsearch-7.12.0/logs/elasticsearch.log\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2021")]),a._v("-04-05 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("13")]),a._v(":36:46,979269 UTC "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8846")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" INFO  Main.cc@106 Parent process died - ML controller exiting\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br"),s("span",{staticClass:"line-number"},[a._v("22")]),s("br"),s("span",{staticClass:"line-number"},[a._v("23")]),s("br"),s("span",{staticClass:"line-number"},[a._v("24")]),s("br"),s("span",{staticClass:"line-number"},[a._v("25")]),s("br"),s("span",{staticClass:"line-number"},[a._v("26")]),s("br"),s("span",{staticClass:"line-number"},[a._v("27")]),s("br"),s("span",{staticClass:"line-number"},[a._v("28")]),s("br"),s("span",{staticClass:"line-number"},[a._v("29")]),s("br"),s("span",{staticClass:"line-number"},[a._v("30")]),s("br"),s("span",{staticClass:"line-number"},[a._v("31")]),s("br")])]),s("p",[a._v("所以我们增加一个独立的elasticsearch用户来运行")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 增加elasticsearch用户")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root-centos elasticsearch-7.12.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# useradd elasticsearch")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root-centos elasticsearch-7.12.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# passwd elasticsearch")]),a._v("\nChanging password "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" user elasticsearch.\nNew password: \nBAD PASSWORD: The password contains the user name "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" some form\nRetype new password: \npasswd: all authentication tokens updated successfully.\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 修改目录权限至新增的elasticsearch用户")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root-centos elasticsearch-7.12.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# chown -R elasticsearch /opt/elasticsearch-7.12.0")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 增加data和log存放区，并赋予elasticsearch用户权限")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root-centos elasticsearch-7.12.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# mkdir -p /data/es")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root-centos elasticsearch-7.12.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# chown -R elasticsearch /data/es")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root-centos elasticsearch-7.12.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# mkdir -p /var/log/es")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root-centos elasticsearch-7.12.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# chown -R elasticsearch /var/log/es")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br")])]),s("p",[a._v("然后修改上述的data和log路径，"),s("code",[a._v("vi /opt/elasticsearch-7.12.0/config/elasticsearch.yml")])]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ----------------------------------- Paths ------------------------------------")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Path to directory where to store the data (separate multiple locations by comma):")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#")]),a._v("\npath.data: /data/es\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# Path to log files:")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#")]),a._v("\npath.logs: /var/log/es\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br")])]),s("ul",[s("li",[s("strong",[a._v("修改Linux系统的限制配置")])])]),a._v(" "),s("ol",[s("li",[a._v("修改系统中允许应用最多创建多少文件等的限制权限。Linux默认来说，一般限制应用最多创建的文件是65535个。但是ES至少需要65536的文件创建权限。")]),a._v(" "),s("li",[a._v("修改系统中允许用户启动的进程开启多少个线程。默认的Linux限制root用户开启的进程可以开启任意数量的线程，其他用户开启的进程可以开启1024个线程。必须修改限制数为4096+。因为ES至少需要4096的线程池预备。ES在5.x版本之后，强制要求在linux中不能使用root用户启动ES进程。所以必须使用其他用户启动ES进程才可以。")]),a._v(" "),s("li",[a._v("Linux低版本内核为线程分配的内存是128K。4.x版本的内核分配的内存更大。如果虚拟机的内存是1G，最多只能开启3000+个线程数。至少为虚拟机分配1.5G以上的内存。")])]),a._v(" "),s("p",[a._v("修改如下配置")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root-centos elasticsearch-7.12.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# vi /etc/security/limits.conf")]),a._v("\n\nelasticsearch soft nofile "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("65536")]),a._v("\nelasticsearch hard nofile "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("65536")]),a._v("\nelasticsearch soft nproc "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4096")]),a._v("\nelasticsearch hard nproc "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4096")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br")])]),s("ul",[s("li",[s("strong",[a._v("启动ElasticSearch")])])]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root-centos elasticsearch-7.12.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# su elasticsearch")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("elasticsearch-centos elasticsearch-7.12.0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("$ ./bin/elasticsearch "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2021")]),a._v("-04-05T22:03:38,332"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("INFO "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("o.e.n.Node               "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("pdai-centos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" version"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7.12")]),a._v(".0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(", pid"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("13197")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(", build"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("default/tar/78722783c38caa25a70982b5b042074cde5d3b3a/2021-03-18T06:17:15.410153305Z"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(", OS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("Linux/3.10.0-862.el7.x86_64/amd64"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(", JVM"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("AdoptOpenJDK/OpenJDK "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("64")]),a._v("-Bit Server VM/15.0.1/15.0.1+9"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2021")]),a._v("-04-05T22:03:38,348"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("INFO "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("o.e.n.Node               "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("pdai-centos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" JVM home "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("/opt/elasticsearch-7.12.0/jdk"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(", using bundled JDK "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("true"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2021")]),a._v("-04-05T22:03:38,348"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("INFO "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("o.e.n.Node               "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("pdai-centos"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" JVM arguments "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("-Xshare:auto, "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Des.networkaddress.cache.ttl")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("60")]),a._v(", "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Des.networkaddress.cache.negative.ttl")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),a._v(", -XX:+AlwaysPreTouch, -Xss1m, "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Djava.awt.headless")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("true, "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Dfile.encoding")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("UTF-8, "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Djna.nosys")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("true, -XX:-OmitStackTraceInFastThrow, -XX:+ShowCodeDetailsInExceptionMessages, "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Dio.netty.noUnsafe")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("true, "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Dio.netty.noKeySetOptimization")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("true, "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Dio.netty.recycler.maxCapacityPerThread")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(", "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Dio.netty.allocator.numDirectArenas")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(", "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Dlog4j.shutdownHookEnabled")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("false, "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Dlog4j2.disable.jmx")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("true, "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Djava.locale.providers")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("SPI,COMPAT, --add-opens"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("java.base/java.io"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("ALL-UNNAMED, -XX:+UseG1GC, "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Djava.io.tmpdir")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/tmp/elasticsearch-17264135248464897093, -XX:+HeapDumpOnOutOfMemoryError, "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:HeapDumpPath")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("data, "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:ErrorFile")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("logs/hs_err_pid%p.log, -Xlog:gc*,gc+age"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("trace,safepoint:file"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("logs/gc.log:utctime,pid,tags:filecount"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("32")]),a._v(",filesize"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("64m, -Xms1894m, -Xmx1894m, "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:MaxDirectMemorySize")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("993001472")]),a._v(", "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:G1HeapRegionSize")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("4m, "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:InitiatingHeapOccupancyPercent")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("30")]),a._v(", "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-XX:G1ReservePercent")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("15")]),a._v(", "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Des.path.home")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/opt/elasticsearch-7.12.0, "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Des.path.conf")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("/opt/elasticsearch-7.12.0/config, "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Des.distribution.flavor")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("default, "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Des.distribution.type")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("tar, "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-Des.bundled_jdk")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("true"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])]),s("ul",[s("li",[s("strong",[a._v("查看安装是否成功")])])]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root-centos ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# netstat -ntlp | grep 9200")]),a._v("\ntcp6       "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("127.0")]),a._v(".0.1:9200          :::*                    LISTEN      "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("13549")]),a._v("/java          \ntcp6       "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v("      "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" ::1:9200                :::*                    LISTEN      "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("13549")]),a._v("/java          \n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root-centos ~"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# curl 127.0.0.1:9200")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"name"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"pdai-centos"')]),a._v(",\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"cluster_name"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"elasticsearch"')]),a._v(",\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"cluster_uuid"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"ihttW8b2TfWSkwf_YgPH2Q"')]),a._v(",\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"version"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"number"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"7.12.0"')]),a._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"build_flavor"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"default"')]),a._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"build_type"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"tar"')]),a._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"build_hash"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"78722783c38caa25a70982b5b042074cde5d3b3a"')]),a._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"build_date"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"2021-03-18T06:17:15.410153305Z"')]),a._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"build_snapshot"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" false,\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"lucene_version"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"8.8.0"')]),a._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"minimum_wire_compatibility_version"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"6.8.0"')]),a._v(",\n    "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"minimum_index_compatibility_version"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"6.0.0-beta1"')]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(",\n  "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"tagline"')]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"You Know, for Search"')]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br")])]),s("h2",{attrs:{id:"安装kibana"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#安装kibana"}},[a._v("#")]),a._v(" 安装Kibana")]),a._v(" "),s("blockquote",[s("p",[a._v("Kibana是界面化的查询数据的工具，下载时尽量下载与ElasicSearch一致的版本。")])]),a._v(" "),s("ul",[s("li",[s("strong",[a._v("下载Kibana")])])]),a._v(" "),s("p",[a._v("从"),s("a",{attrs:{href:"https://www.elastic.co/cn/downloads/kibana",target:"_blank",rel:"noopener noreferrer"}},[a._v("这里在新窗口打开"),s("OutboundLink")],1),a._v("下载Kibana")]),a._v(" "),s("ul",[s("li",[s("strong",[a._v("解压")])])]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root-centos opt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# tar -vxzf kibana-7.12.0-linux-x86_64.tar.gz")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ul",[s("li",[s("strong",[a._v("使用elasticsearch用户权限")])])]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root-centos opt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# chown -R elasticsearch /opt/kibana-7.12.0-linux-x86_64")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#配置Kibana的远程访问")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root-centos opt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# vi /opt/kibana-7.12.0-linux-x86_64/config/kibana.yml")]),a._v("\nserver.host: "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0.0")]),a._v(".0.0\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("ul",[s("li",[s("strong",[a._v("启动")])])]),a._v(" "),s("p",[a._v("需要切换至elasticsearch用户")]),a._v(" "),s("div",{staticClass:"language-sh line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sh"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("root-centos opt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# su elasticsearch")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("elasticsearch-centos opt"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("$ "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("cd")]),a._v(" /opt/kibana-7.12.0-linux-x86_64/\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("elasticsearch-centos kibana-7.12.0-linux-x86_64"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("$ ./bin/kibana\n  log   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(":30:22.185"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("info"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("plugins-service"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" Plugin "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"osquery"')]),a._v(" is disabled.\n  log   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(":30:22.283"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("warning"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("config"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("deprecation"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" Config key "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("monitoring.cluster_alerts.email_notifications.email_address"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" will be required "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" email notifications to work "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8.0")]),a._v('."\n  log   '),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(":30:22.482"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("info"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("plugins-system"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" Setting up "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("100")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" plugins: "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("taskManager,licensing,globalSearch,globalSearchProviders,banners,code,usageCollection,xpackLegacy,telemetryCollectionManager,telemetry,telemetryCollectionXpack,kibanaUsageCollection,securityOss,share,newsfeed,mapsLegacy,kibanaLegacy,translations,legacyExport,embeddable,uiActionsEnhanced,expressions,charts,esUiShared,bfetch,data,home,observability,console,consoleExtensions,apmOss,searchprofiler,painlessLab,grokdebugger,management,indexPatternManagement,advancedSettings,fileUpload,savedObjects,visualizations,visTypeVislib,visTypeVega,visTypeTimelion,features,licenseManagement,watcher,canvas,visTypeTagcloud,visTypeTable,visTypeMetric,visTypeMarkdown,tileMap,regionMap,visTypeXy,graph,timelion,dashboard,dashboardEnhanced,visualize,visTypeTimeseries,inputControlVis,discover,discoverEnhanced,savedObjectsManagement,spaces,security,savedObjectsTagging,maps,lens,reporting,lists,encryptedSavedObjects,dashboardMode,dataEnhanced,cloud,upgradeAssistant,snapshotRestore,fleet,indexManagement,rollup,remoteClusters,crossClusterReplication,indexLifecycleManagement,enterpriseSearch,beatsManagement,transform,ingestPipelines,eventLog,actions,alerts,triggersActionsUi,stackAlerts,ml,securitySolution,case,infra,monitoring,logstash,apm,uptime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n  log   "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("22")]),a._v(":30:22.483"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("info"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("plugins"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("taskManager"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" TaskManager is identified by the Kibana UUID: xxxxxx\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v(".\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br")])]),s("p",[a._v("如果是后台启动：")]),a._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",[s("code",[a._v("[elasticsearch-centos kibana-7.12.0-linux-x86_64]$ nohup ./bin/kibana &\n")])])]),s("ul",[s("li",[s("strong",[a._v("界面访问")])])]),a._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/willpast/image/blog/ka_java/es-install-1.png",alt:"img"}})]),a._v(" "),s("p",[a._v("可以导入simple data")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/willpast/image/blog/ka_java/es-install-2.png",alt:"img"}})]),a._v(" "),s("p",[a._v("查看数据")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/willpast/image/blog/ka_java/es-install-3.png",alt:"img"}})]),a._v(" "),s("h2",{attrs:{id:"配置密码访问"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置密码访问"}},[a._v("#")]),a._v(" 配置密码访问")]),a._v(" "),s("blockquote",[s("p",[a._v("使用基本许可证时，默认情况下禁用Elasticsearch安全功能。由于我测试环境是放在公网上的，所以需要设置下密码访问。相关文档可以参考[这里在新窗口打开](https://www.elastic.co/guide/en/elasticsearch/reference/7.12/security-\nminimal-setup.html)")])]),a._v(" "),s("ol",[s("li",[a._v("停止kibana和elasticsearch服务")]),a._v(" "),s("li",[a._v("将"),s("code",[a._v("xpack.security.enabled")]),a._v("设置添加到ES_PATH_CONF/elasticsearch.yml文件并将值设置为true")]),a._v(" "),s("li",[a._v("启动elasticsearch ("),s("code",[a._v("./bin/elasticsearch -d")]),a._v(")")]),a._v(" "),s("li",[a._v("执行如下密码设置器，"),s("code",[a._v("./bin/elasticsearch-setup-passwords interactive")]),a._v("来设置各个组件的密码")]),a._v(" "),s("li",[a._v("将elasticsearch.username设置添加到KIB_PATH_CONF/kibana.yml 文件并将值设置给elastic用户： "),s("code",[a._v('elasticsearch.username: "elastic"')])]),a._v(" "),s("li",[a._v("创建kibana keystore, "),s("code",[a._v("./bin/kibana-keystore create")])]),a._v(" "),s("li",[a._v("在kibana keystore 中添加密码 "),s("code",[a._v("./bin/kibana-keystore add elasticsearch.password")])]),a._v(" "),s("li",[a._v("重启kibana 服务即可 "),s("code",[a._v("nohup ./bin/kibana &")])])]),a._v(" "),s("p",[a._v("然后就可以使用密码登录了：")]),a._v(" "),s("p",[s("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/willpast/image/blog/ka_java/es-install-4.png",alt:"img"}})])])}),[],!1,null,null,null);s.default=e.exports}}]);