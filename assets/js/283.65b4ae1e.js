(window.webpackJsonp=window.webpackJsonp||[]).push([[283],{615:function(s,n,a){"use strict";a.r(n);var e=a(4),t=Object(e.a)({},(function(){var s=this,n=s._self._c;return n("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[n("h1",{attrs:{id:"es详解-聚合-聚合查询之metric聚合详解"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#es详解-聚合-聚合查询之metric聚合详解"}},[s._v("#")]),s._v(" ES详解 - 聚合：聚合查询之Metric聚合详解")]),s._v(" "),n("blockquote",[n("p",[s._v("前文主要讲了 ElasticSearch提供的三种聚合方式之"),n("strong",[s._v("桶聚合（Bucket Aggregation)")]),s._v("\n，本文主要讲讲"),n("strong",[s._v("指标聚合（Metric Aggregation)")]),s._v(" 。")])]),s._v(" "),n("h2",{attrs:{id:"如何理解metric聚合"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#如何理解metric聚合"}},[s._v("#")]),s._v(" 如何理解metric聚合")]),s._v(" "),n("blockquote",[n("p",[s._v("在[bucket聚合](/pages/es-agg-\nbucket.html)中，我画了一张图辅助你构筑体系，那么metric聚合又如何理解呢？")])]),s._v(" "),n("p",[s._v("如果你直接去看官方文档，大概也有十几种：")]),s._v(" "),n("p",[n("img",{attrs:{src:"https://cdn.jsdelivr.net/gh/willpast/image/blog/ka_java/es-agg-metric-1.png",alt:"img"}})]),s._v(" "),n("blockquote",[n("p",[s._v("那么metric聚合又如何理解呢？我认为从两个角度：")])]),s._v(" "),n("ul",[n("li",[n("strong",[s._v("从分类看")]),s._v(" ：Metric聚合分析分为"),n("strong",[s._v("单值分析")]),s._v(" 和"),n("strong",[s._v("多值分析")]),s._v(" 两类")]),s._v(" "),n("li",[n("strong",[s._v("从功能看")]),s._v(" ：根据具体的应用场景设计了一些分析api, 比如地理位置，百分数等等")])]),s._v(" "),n("blockquote",[n("p",[s._v("融合上述两个方面，我们可以梳理出大致的一个mind图：")])]),s._v(" "),n("ul",[n("li",[n("strong",[s._v("单值分析")]),s._v(" : 只输出一个分析结果\n"),n("ul",[n("li",[s._v("标准stat型\n"),n("ul",[n("li",[n("code",[s._v("avg")]),s._v(" 平均值")]),s._v(" "),n("li",[n("code",[s._v("max")]),s._v(" 最大值")]),s._v(" "),n("li",[n("code",[s._v("min")]),s._v(" 最小值")]),s._v(" "),n("li",[n("code",[s._v("sum")]),s._v(" 和")]),s._v(" "),n("li",[n("code",[s._v("value_count")]),s._v(" 数量")])])]),s._v(" "),n("li",[s._v("其它类型\n"),n("ul",[n("li",[n("code",[s._v("cardinality")]),s._v(" 基数（distinct去重）")]),s._v(" "),n("li",[n("code",[s._v("weighted_avg")]),s._v(" 带权重的avg")]),s._v(" "),n("li",[n("code",[s._v("median_absolute_deviation")]),s._v(" 中位值")])])])])]),s._v(" "),n("li",[n("strong",[s._v("多值分析")]),s._v(" : 单值之外的\n"),n("ul",[n("li",[s._v("stats型\n"),n("ul",[n("li",[n("code",[s._v("stats")]),s._v(" 包含avg,max,min,sum和count")]),s._v(" "),n("li",[n("code",[s._v("matrix_stats")]),s._v(" 针对矩阵模型")]),s._v(" "),n("li",[n("code",[s._v("extended_stats")])]),s._v(" "),n("li",[n("code",[s._v("string_stats")]),s._v(" 针对字符串")])])]),s._v(" "),n("li",[s._v("百分数型\n"),n("ul",[n("li",[n("code",[s._v("percentiles")]),s._v(" 百分数范围")]),s._v(" "),n("li",[n("code",[s._v("percentile_ranks")]),s._v(" 百分数排行")])])]),s._v(" "),n("li",[s._v("地理位置型\n"),n("ul",[n("li",[n("code",[s._v("geo_bounds")]),s._v(" Geo bounds")]),s._v(" "),n("li",[n("code",[s._v("geo_centroid")]),s._v(" Geo-centroid")]),s._v(" "),n("li",[n("code",[s._v("geo_line")]),s._v(" Geo-Line")])])]),s._v(" "),n("li",[s._v("Top型\n"),n("ul",[n("li",[n("code",[s._v("top_hits")]),s._v(" 分桶后的top hits")]),s._v(" "),n("li",[n("code",[s._v("top_metrics")])])])])])])]),s._v(" "),n("blockquote",[n("p",[n("strong",[s._v("通过上述列表（我就不画图了），我们构筑的体系是基于"),n("code",[s._v("分类")]),s._v("和"),n("code",[s._v("功能")]),s._v("，而不是具体的项（比如avg,percentiles...)；这是不同的认知维度:\n具体的项是碎片化，分类和功能这种是你需要构筑的体系")]),s._v("。")])]),s._v(" "),n("h2",{attrs:{id:"单值分析-标准stat类型"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#单值分析-标准stat类型"}},[s._v("#")]),s._v(" 单值分析: 标准stat类型")]),s._v(" "),n("h3",{attrs:{id:"avg-平均值"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#avg-平均值"}},[s._v("#")]),s._v(" "),n("code",[s._v("avg")]),s._v(" 平均值")]),s._v(" "),n("p",[s._v("计算班级的平均分")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    POST /exams/_search?size=0\n    {\n      "aggs": {\n        "avg_grade": { "avg": { "field": "grade" } }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("返回")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    {\n      ...\n      "aggregations": {\n        "avg_grade": {\n          "value": 75.0\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h3",{attrs:{id:"max-最大值"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#max-最大值"}},[s._v("#")]),s._v(" "),n("code",[s._v("max")]),s._v(" 最大值")]),s._v(" "),n("p",[s._v("计算销售最高价")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    POST /sales/_search?size=0\n    {\n      "aggs": {\n        "max_price": { "max": { "field": "price" } }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("返回")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    {\n      ...\n      "aggregations": {\n          "max_price": {\n              "value": 200.0\n          }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h3",{attrs:{id:"min-最小值"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#min-最小值"}},[s._v("#")]),s._v(" "),n("code",[s._v("min")]),s._v(" 最小值")]),s._v(" "),n("p",[s._v("计算销售最低价")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    POST /sales/_search?size=0\n    {\n      "aggs": {\n        "min_price": { "min": { "field": "price" } }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("返回")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    {\n      ...\n    \n      "aggregations": {\n        "min_price": {\n          "value": 10.0\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br")])]),n("h3",{attrs:{id:"sum-和"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#sum-和"}},[s._v("#")]),s._v(" "),n("code",[s._v("sum")]),s._v(" 和")]),s._v(" "),n("p",[s._v("计算销售总价")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    POST /sales/_search?size=0\n    {\n      "query": {\n        "constant_score": {\n          "filter": {\n            "match": { "type": "hat" }\n          }\n        }\n      },\n      "aggs": {\n        "hat_prices": { "sum": { "field": "price" } }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("p",[s._v("返回")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    {\n      ...\n      "aggregations": {\n        "hat_prices": {\n          "value": 450.0\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h3",{attrs:{id:"value-count-数量"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#value-count-数量"}},[s._v("#")]),s._v(" "),n("code",[s._v("value_count")]),s._v(" 数量")]),s._v(" "),n("p",[s._v("销售数量统计")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    POST /sales/_search?size=0\n    {\n      "aggs" : {\n        "types_count" : { "value_count" : { "field" : "type" } }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("返回")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    {\n      ...\n      "aggregations": {\n        "types_count": {\n          "value": 7\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h2",{attrs:{id:"单值分析-其它类型"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#单值分析-其它类型"}},[s._v("#")]),s._v(" 单值分析: 其它类型")]),s._v(" "),n("h3",{attrs:{id:"weighted-avg-带权重的avg"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#weighted-avg-带权重的avg"}},[s._v("#")]),s._v(" "),n("code",[s._v("weighted_avg")]),s._v(" 带权重的avg")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    POST /exams/_search\n    {\n      "size": 0,\n      "aggs": {\n        "weighted_grade": {\n          "weighted_avg": {\n            "value": {\n              "field": "grade"\n            },\n            "weight": {\n              "field": "weight"\n            }\n          }\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("p",[s._v("返回")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    {\n      ...\n      "aggregations": {\n        "weighted_grade": {\n          "value": 70.0\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h3",{attrs:{id:"cardinality-基数-distinct去重"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#cardinality-基数-distinct去重"}},[s._v("#")]),s._v(" "),n("code",[s._v("cardinality")]),s._v(" 基数（distinct去重）")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    POST /sales/_search?size=0\n    {\n      "aggs": {\n        "type_count": {\n          "cardinality": {\n            "field": "type"\n          }\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[s._v("返回")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    {\n      ...\n      "aggregations": {\n        "type_count": {\n          "value": 3\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br")])]),n("h3",{attrs:{id:"median-absolute-deviation-中位值"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#median-absolute-deviation-中位值"}},[s._v("#")]),s._v(" "),n("code",[s._v("median_absolute_deviation")]),s._v(" 中位值")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    GET reviews/_search\n    {\n      "size": 0,\n      "aggs": {\n        "review_average": {\n          "avg": {\n            "field": "rating"\n          }\n        },\n        "review_variability": {\n          "median_absolute_deviation": {\n            "field": "rating" \n          }\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br")])]),n("p",[s._v("返回")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    {\n      ...\n      "aggregations": {\n        "review_average": {\n          "value": 3.0\n        },\n        "review_variability": {\n          "value": 2.0\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("h2",{attrs:{id:"非单值分析-stats型"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#非单值分析-stats型"}},[s._v("#")]),s._v(" 非单值分析：stats型")]),s._v(" "),n("h3",{attrs:{id:"stats-包含avg-max-min-sum和count"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#stats-包含avg-max-min-sum和count"}},[s._v("#")]),s._v(" "),n("code",[s._v("stats")]),s._v(" 包含avg,max,min,sum和count")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    POST /exams/_search?size=0\n    {\n      "aggs": {\n        "grades_stats": { "stats": { "field": "grade" } }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("返回")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    {\n      ...\n    \n      "aggregations": {\n        "grades_stats": {\n          "count": 2,\n          "min": 50.0,\n          "max": 100.0,\n          "avg": 75.0,\n          "sum": 150.0\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("h3",{attrs:{id:"matrix-stats-针对矩阵模型"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#matrix-stats-针对矩阵模型"}},[s._v("#")]),s._v(" "),n("code",[s._v("matrix_stats")]),s._v(" 针对矩阵模型")]),s._v(" "),n("p",[s._v("以下示例说明了使用矩阵统计量来描述收入与贫困之间的关系。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    GET /_search\n    {\n      "aggs": {\n        "statistics": {\n          "matrix_stats": {\n            "fields": [ "poverty", "income" ]\n          }\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br")])]),n("p",[s._v("返回")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    {\n      ...\n      "aggregations": {\n        "statistics": {\n          "doc_count": 50,\n          "fields": [ {\n              "name": "income",\n              "count": 50,\n              "mean": 51985.1,\n              "variance": 7.383377037755103E7,\n              "skewness": 0.5595114003506483,\n              "kurtosis": 2.5692365287787124,\n              "covariance": {\n                "income": 7.383377037755103E7,\n                "poverty": -21093.65836734694\n              },\n              "correlation": {\n                "income": 1.0,\n                "poverty": -0.8352655256272504\n              }\n            }, {\n              "name": "poverty",\n              "count": 50,\n              "mean": 12.732000000000001,\n              "variance": 8.637730612244896,\n              "skewness": 0.4516049811903419,\n              "kurtosis": 2.8615929677997767,\n              "covariance": {\n                "income": -21093.65836734694,\n                "poverty": 8.637730612244896\n              },\n              "correlation": {\n                "income": -0.8352655256272504,\n                "poverty": 1.0\n              }\n            } ]\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br")])]),n("h3",{attrs:{id:"extended-stats"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#extended-stats"}},[s._v("#")]),s._v(" "),n("code",[s._v("extended_stats")])]),s._v(" "),n("p",[s._v("根据从汇总文档中提取的数值计算统计信息。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    GET /exams/_search\n    {\n      "size": 0,\n      "aggs": {\n        "grades_stats": { "extended_stats": { "field": "grade" } }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("p",[s._v("上面的汇总计算了所有文档的成绩统计信息。聚合类型为extended_stats，并且字段设置定义将在其上计算统计信息的文档的数字字段。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    {\n      ...\n    \n      "aggregations": {\n        "grades_stats": {\n          "count": 2,\n          "min": 50.0,\n          "max": 100.0,\n          "avg": 75.0,\n          "sum": 150.0,\n          "sum_of_squares": 12500.0,\n          "variance": 625.0,\n          "variance_population": 625.0,\n          "variance_sampling": 1250.0,\n          "std_deviation": 25.0,\n          "std_deviation_population": 25.0,\n          "std_deviation_sampling": 35.35533905932738,\n          "std_deviation_bounds": {\n            "upper": 125.0,\n            "lower": 25.0,\n            "upper_population": 125.0,\n            "lower_population": 25.0,\n            "upper_sampling": 145.71067811865476,\n            "lower_sampling": 4.289321881345245\n          }\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br")])]),n("h3",{attrs:{id:"string-stats-针对字符串"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#string-stats-针对字符串"}},[s._v("#")]),s._v(" "),n("code",[s._v("string_stats")]),s._v(" 针对字符串")]),s._v(" "),n("p",[s._v("用于计算从聚合文档中提取的字符串值的统计信息。这些值可以从特定的关键字字段中检索。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    POST /my-index-000001/_search?size=0\n    {\n      "aggs": {\n        "message_stats": { "string_stats": { "field": "message.keyword" } }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br")])]),n("p",[s._v("返回")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    {\n      ...\n    \n      "aggregations": {\n        "message_stats": {\n          "count": 5,\n          "min_length": 24,\n          "max_length": 30,\n          "avg_length": 28.8,\n          "entropy": 3.94617750050791\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br")])]),n("h2",{attrs:{id:"非单值分析-百分数型"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#非单值分析-百分数型"}},[s._v("#")]),s._v(" 非单值分析：百分数型")]),s._v(" "),n("h3",{attrs:{id:"percentiles-百分数范围"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#percentiles-百分数范围"}},[s._v("#")]),s._v(" "),n("code",[s._v("percentiles")]),s._v(" 百分数范围")]),s._v(" "),n("p",[s._v("针对从聚合文档中提取的数值计算一个或多个百分位数。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    GET latency/_search\n    {\n      "size": 0,\n      "aggs": {\n        "load_time_outlier": {\n          "percentiles": {\n            "field": "load_time" \n          }\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br")])]),n("p",[s._v("默认情况下，百分位度量标准将生成一定范围的百分位：[1，5，25，50，75，95，99]。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    {\n      ...\n    \n     "aggregations": {\n        "load_time_outlier": {\n          "values": {\n            "1.0": 5.0,\n            "5.0": 25.0,\n            "25.0": 165.0,\n            "50.0": 445.0,\n            "75.0": 725.0,\n            "95.0": 945.0,\n            "99.0": 985.0\n          }\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("h3",{attrs:{id:"percentile-ranks-百分数排行"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#percentile-ranks-百分数排行"}},[s._v("#")]),s._v(" "),n("code",[s._v("percentile_ranks")]),s._v(" 百分数排行")]),s._v(" "),n("p",[s._v("根据从汇总文档中提取的数值计算一个或多个百分位等级。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    GET latency/_search\n    {\n      "size": 0,\n      "aggs": {\n        "load_time_ranks": {\n          "percentile_ranks": {\n            "field": "load_time",   \n            "values": [ 500, 600 ]\n          }\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("p",[s._v("返回")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    {\n      ...\n    \n     "aggregations": {\n        "load_time_ranks": {\n          "values": {\n            "500.0": 90.01,\n            "600.0": 100.0\n          }\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("p",[s._v("上述结果表示90.01％的页面加载在500ms内完成，而100％的页面加载在600ms内完成。")]),s._v(" "),n("h2",{attrs:{id:"非单值分析-地理位置型"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#非单值分析-地理位置型"}},[s._v("#")]),s._v(" 非单值分析：地理位置型")]),s._v(" "),n("h3",{attrs:{id:"geo-bounds-geo-bounds"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#geo-bounds-geo-bounds"}},[s._v("#")]),s._v(" "),n("code",[s._v("geo_bounds")]),s._v(" Geo bounds")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    PUT /museums\n    {\n      "mappings": {\n        "properties": {\n          "location": {\n            "type": "geo_point"\n          }\n        }\n      }\n    }\n    \n    POST /museums/_bulk?refresh\n    {"index":{"_id":1}}\n    {"location": "52.374081,4.912350", "name": "NEMO Science Museum"}\n    {"index":{"_id":2}}\n    {"location": "52.369219,4.901618", "name": "Museum Het Rembrandthuis"}\n    {"index":{"_id":3}}\n    {"location": "52.371667,4.914722", "name": "Nederlands Scheepvaartmuseum"}\n    {"index":{"_id":4}}\n    {"location": "51.222900,4.405200", "name": "Letterenhuis"}\n    {"index":{"_id":5}}\n    {"location": "48.861111,2.336389", "name": "Musée du Louvre"}\n    {"index":{"_id":6}}\n    {"location": "48.860000,2.327000", "name": "Musée d\'Orsay"}\n    \n    POST /museums/_search?size=0\n    {\n      "query": {\n        "match": { "name": "musée" }\n      },\n      "aggs": {\n        "viewport": {\n          "geo_bounds": {\n            "field": "location",    \n            "wrap_longitude": true  \n          }\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br")])]),n("p",[s._v("上面的汇总展示了如何针对具有商店业务类型的所有文档计算位置字段的边界框")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    {\n      ...\n      "aggregations": {\n        "viewport": {\n          "bounds": {\n            "top_left": {\n              "lat": 48.86111099738628,\n              "lon": 2.3269999679178\n            },\n            "bottom_right": {\n              "lat": 48.85999997612089,\n              "lon": 2.3363889567553997\n            }\n          }\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br")])]),n("h3",{attrs:{id:"geo-centroid-geo-centroid"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#geo-centroid-geo-centroid"}},[s._v("#")]),s._v(" "),n("code",[s._v("geo_centroid")]),s._v(" Geo-centroid")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    PUT /museums\n    {\n      "mappings": {\n        "properties": {\n          "location": {\n            "type": "geo_point"\n          }\n        }\n      }\n    }\n    \n    POST /museums/_bulk?refresh\n    {"index":{"_id":1}}\n    {"location": "52.374081,4.912350", "city": "Amsterdam", "name": "NEMO Science Museum"}\n    {"index":{"_id":2}}\n    {"location": "52.369219,4.901618", "city": "Amsterdam", "name": "Museum Het Rembrandthuis"}\n    {"index":{"_id":3}}\n    {"location": "52.371667,4.914722", "city": "Amsterdam", "name": "Nederlands Scheepvaartmuseum"}\n    {"index":{"_id":4}}\n    {"location": "51.222900,4.405200", "city": "Antwerp", "name": "Letterenhuis"}\n    {"index":{"_id":5}}\n    {"location": "48.861111,2.336389", "city": "Paris", "name": "Musée du Louvre"}\n    {"index":{"_id":6}}\n    {"location": "48.860000,2.327000", "city": "Paris", "name": "Musée d\'Orsay"}\n    \n    POST /museums/_search?size=0\n    {\n      "aggs": {\n        "centroid": {\n          "geo_centroid": {\n            "field": "location" \n          }\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br")])]),n("p",[s._v("上面的汇总显示了如何针对所有具有犯罪类型的盗窃文件计算位置字段的质心。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    {\n      ...\n      "aggregations": {\n        "centroid": {\n          "location": {\n            "lat": 51.00982965203002,\n            "lon": 3.9662131341174245\n          },\n          "count": 6\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br")])]),n("h3",{attrs:{id:"geo-line-geo-line"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#geo-line-geo-line"}},[s._v("#")]),s._v(" "),n("code",[s._v("geo_line")]),s._v(" Geo-Line")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    PUT test\n    {\n        "mappings": {\n            "dynamic": "strict",\n            "_source": {\n                "enabled": false\n            },\n            "properties": {\n                "my_location": {\n                    "type": "geo_point"\n                },\n                "group": {\n                    "type": "keyword"\n                },\n                "@timestamp": {\n                    "type": "date"\n                }\n            }\n        }\n    }\n    \n    POST /test/_bulk?refresh\n    {"index": {}}\n    {"my_location": {"lat":37.3450570, "lon": -122.0499820}, "@timestamp": "2013-09-06T16:00:36"}\n    {"index": {}}\n    {"my_location": {"lat": 37.3451320, "lon": -122.0499820}, "@timestamp": "2013-09-06T16:00:37Z"}\n    {"index": {}}\n    {"my_location": {"lat": 37.349283, "lon": -122.0505010}, "@timestamp": "2013-09-06T16:00:37Z"}\n    \n    POST /test/_search?filter_path=aggregations\n    {\n      "aggs": {\n        "line": {\n          "geo_line": {\n            "point": {"field": "my_location"},\n            "sort": {"field": "@timestamp"}\n          }\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br")])]),n("p",[s._v("将存储桶中的所有geo_point值聚合到由所选排序字段排序的LineString中。")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    {\n      "aggregations": {\n        "line": {\n          "type" : "Feature",\n          "geometry" : {\n            "type" : "LineString",\n            "coordinates" : [\n              [\n                -122.049982,\n                37.345057\n              ],\n              [\n                -122.050501,\n                37.349283\n              ],\n              [\n                -122.049982,\n                37.345132\n              ]\n            ]\n          },\n          "properties" : {\n            "complete" : true\n          }\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br")])]),n("h2",{attrs:{id:"非单值分析-top型"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#非单值分析-top型"}},[s._v("#")]),s._v(" 非单值分析：Top型")]),s._v(" "),n("h3",{attrs:{id:"top-hits-分桶后的top-hits"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#top-hits-分桶后的top-hits"}},[s._v("#")]),s._v(" "),n("code",[s._v("top_hits")]),s._v(" 分桶后的top hits")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    POST /sales/_search?size=0\n    {\n      "aggs": {\n        "top_tags": {\n          "terms": {\n            "field": "type",\n            "size": 3\n          },\n          "aggs": {\n            "top_sales_hits": {\n              "top_hits": {\n                "sort": [\n                  {\n                    "date": {\n                      "order": "desc"\n                    }\n                  }\n                ],\n                "_source": {\n                  "includes": [ "date", "price" ]\n                },\n                "size": 1\n              }\n            }\n          }\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br")])]),n("p",[s._v("返回")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    {\n      ...\n      "aggregations": {\n        "top_tags": {\n           "doc_count_error_upper_bound": 0,\n           "sum_other_doc_count": 0,\n           "buckets": [\n              {\n                 "key": "hat",\n                 "doc_count": 3,\n                 "top_sales_hits": {\n                    "hits": {\n                       "total" : {\n                           "value": 3,\n                           "relation": "eq"\n                       },\n                       "max_score": null,\n                       "hits": [\n                          {\n                             "_index": "sales",\n                             "_type": "_doc",\n                             "_id": "AVnNBmauCQpcRyxw6ChK",\n                             "_source": {\n                                "date": "2015/03/01 00:00:00",\n                                "price": 200\n                             },\n                             "sort": [\n                                1425168000000\n                             ],\n                             "_score": null\n                          }\n                       ]\n                    }\n                 }\n              },\n              {\n                 "key": "t-shirt",\n                 "doc_count": 3,\n                 "top_sales_hits": {\n                    "hits": {\n                       "total" : {\n                           "value": 3,\n                           "relation": "eq"\n                       },\n                       "max_score": null,\n                       "hits": [\n                          {\n                             "_index": "sales",\n                             "_type": "_doc",\n                             "_id": "AVnNBmauCQpcRyxw6ChL",\n                             "_source": {\n                                "date": "2015/03/01 00:00:00",\n                                "price": 175\n                             },\n                             "sort": [\n                                1425168000000\n                             ],\n                             "_score": null\n                          }\n                       ]\n                    }\n                 }\n              },\n              {\n                 "key": "bag",\n                 "doc_count": 1,\n                 "top_sales_hits": {\n                    "hits": {\n                       "total" : {\n                           "value": 1,\n                           "relation": "eq"\n                       },\n                       "max_score": null,\n                       "hits": [\n                          {\n                             "_index": "sales",\n                             "_type": "_doc",\n                             "_id": "AVnNBmatCQpcRyxw6ChH",\n                             "_source": {\n                                "date": "2015/01/01 00:00:00",\n                                "price": 150\n                             },\n                             "sort": [\n                                1420070400000\n                             ],\n                             "_score": null\n                          }\n                       ]\n                    }\n                 }\n              }\n           ]\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br"),n("span",{staticClass:"line-number"},[s._v("19")]),n("br"),n("span",{staticClass:"line-number"},[s._v("20")]),n("br"),n("span",{staticClass:"line-number"},[s._v("21")]),n("br"),n("span",{staticClass:"line-number"},[s._v("22")]),n("br"),n("span",{staticClass:"line-number"},[s._v("23")]),n("br"),n("span",{staticClass:"line-number"},[s._v("24")]),n("br"),n("span",{staticClass:"line-number"},[s._v("25")]),n("br"),n("span",{staticClass:"line-number"},[s._v("26")]),n("br"),n("span",{staticClass:"line-number"},[s._v("27")]),n("br"),n("span",{staticClass:"line-number"},[s._v("28")]),n("br"),n("span",{staticClass:"line-number"},[s._v("29")]),n("br"),n("span",{staticClass:"line-number"},[s._v("30")]),n("br"),n("span",{staticClass:"line-number"},[s._v("31")]),n("br"),n("span",{staticClass:"line-number"},[s._v("32")]),n("br"),n("span",{staticClass:"line-number"},[s._v("33")]),n("br"),n("span",{staticClass:"line-number"},[s._v("34")]),n("br"),n("span",{staticClass:"line-number"},[s._v("35")]),n("br"),n("span",{staticClass:"line-number"},[s._v("36")]),n("br"),n("span",{staticClass:"line-number"},[s._v("37")]),n("br"),n("span",{staticClass:"line-number"},[s._v("38")]),n("br"),n("span",{staticClass:"line-number"},[s._v("39")]),n("br"),n("span",{staticClass:"line-number"},[s._v("40")]),n("br"),n("span",{staticClass:"line-number"},[s._v("41")]),n("br"),n("span",{staticClass:"line-number"},[s._v("42")]),n("br"),n("span",{staticClass:"line-number"},[s._v("43")]),n("br"),n("span",{staticClass:"line-number"},[s._v("44")]),n("br"),n("span",{staticClass:"line-number"},[s._v("45")]),n("br"),n("span",{staticClass:"line-number"},[s._v("46")]),n("br"),n("span",{staticClass:"line-number"},[s._v("47")]),n("br"),n("span",{staticClass:"line-number"},[s._v("48")]),n("br"),n("span",{staticClass:"line-number"},[s._v("49")]),n("br"),n("span",{staticClass:"line-number"},[s._v("50")]),n("br"),n("span",{staticClass:"line-number"},[s._v("51")]),n("br"),n("span",{staticClass:"line-number"},[s._v("52")]),n("br"),n("span",{staticClass:"line-number"},[s._v("53")]),n("br"),n("span",{staticClass:"line-number"},[s._v("54")]),n("br"),n("span",{staticClass:"line-number"},[s._v("55")]),n("br"),n("span",{staticClass:"line-number"},[s._v("56")]),n("br"),n("span",{staticClass:"line-number"},[s._v("57")]),n("br"),n("span",{staticClass:"line-number"},[s._v("58")]),n("br"),n("span",{staticClass:"line-number"},[s._v("59")]),n("br"),n("span",{staticClass:"line-number"},[s._v("60")]),n("br"),n("span",{staticClass:"line-number"},[s._v("61")]),n("br"),n("span",{staticClass:"line-number"},[s._v("62")]),n("br"),n("span",{staticClass:"line-number"},[s._v("63")]),n("br"),n("span",{staticClass:"line-number"},[s._v("64")]),n("br"),n("span",{staticClass:"line-number"},[s._v("65")]),n("br"),n("span",{staticClass:"line-number"},[s._v("66")]),n("br"),n("span",{staticClass:"line-number"},[s._v("67")]),n("br"),n("span",{staticClass:"line-number"},[s._v("68")]),n("br"),n("span",{staticClass:"line-number"},[s._v("69")]),n("br"),n("span",{staticClass:"line-number"},[s._v("70")]),n("br"),n("span",{staticClass:"line-number"},[s._v("71")]),n("br"),n("span",{staticClass:"line-number"},[s._v("72")]),n("br"),n("span",{staticClass:"line-number"},[s._v("73")]),n("br"),n("span",{staticClass:"line-number"},[s._v("74")]),n("br"),n("span",{staticClass:"line-number"},[s._v("75")]),n("br"),n("span",{staticClass:"line-number"},[s._v("76")]),n("br"),n("span",{staticClass:"line-number"},[s._v("77")]),n("br"),n("span",{staticClass:"line-number"},[s._v("78")]),n("br"),n("span",{staticClass:"line-number"},[s._v("79")]),n("br"),n("span",{staticClass:"line-number"},[s._v("80")]),n("br"),n("span",{staticClass:"line-number"},[s._v("81")]),n("br"),n("span",{staticClass:"line-number"},[s._v("82")]),n("br"),n("span",{staticClass:"line-number"},[s._v("83")]),n("br"),n("span",{staticClass:"line-number"},[s._v("84")]),n("br"),n("span",{staticClass:"line-number"},[s._v("85")]),n("br"),n("span",{staticClass:"line-number"},[s._v("86")]),n("br"),n("span",{staticClass:"line-number"},[s._v("87")]),n("br"),n("span",{staticClass:"line-number"},[s._v("88")]),n("br"),n("span",{staticClass:"line-number"},[s._v("89")]),n("br"),n("span",{staticClass:"line-number"},[s._v("90")]),n("br"),n("span",{staticClass:"line-number"},[s._v("91")]),n("br"),n("span",{staticClass:"line-number"},[s._v("92")]),n("br"),n("span",{staticClass:"line-number"},[s._v("93")]),n("br"),n("span",{staticClass:"line-number"},[s._v("94")]),n("br"),n("span",{staticClass:"line-number"},[s._v("95")]),n("br")])]),n("h3",{attrs:{id:"top-metrics"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#top-metrics"}},[s._v("#")]),s._v(" "),n("code",[s._v("top_metrics")])]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    POST /test/_bulk?refresh\n    {"index": {}}\n    {"s": 1, "m": 3.1415}\n    {"index": {}}\n    {"s": 2, "m": 1.0}\n    {"index": {}}\n    {"s": 3, "m": 2.71828}\n    POST /test/_search?filter_path=aggregations\n    {\n      "aggs": {\n        "tm": {\n          "top_metrics": {\n            "metrics": {"field": "m"},\n            "sort": {"s": "desc"}\n          }\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br"),n("span",{staticClass:"line-number"},[s._v("8")]),n("br"),n("span",{staticClass:"line-number"},[s._v("9")]),n("br"),n("span",{staticClass:"line-number"},[s._v("10")]),n("br"),n("span",{staticClass:"line-number"},[s._v("11")]),n("br"),n("span",{staticClass:"line-number"},[s._v("12")]),n("br"),n("span",{staticClass:"line-number"},[s._v("13")]),n("br"),n("span",{staticClass:"line-number"},[s._v("14")]),n("br"),n("span",{staticClass:"line-number"},[s._v("15")]),n("br"),n("span",{staticClass:"line-number"},[s._v("16")]),n("br"),n("span",{staticClass:"line-number"},[s._v("17")]),n("br"),n("span",{staticClass:"line-number"},[s._v("18")]),n("br")])]),n("p",[s._v("返回")]),s._v(" "),n("div",{staticClass:"language- line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-text"}},[n("code",[s._v('    {\n      "aggregations": {\n        "tm": {\n          "top": [ {"sort": [3], "metrics": {"m": 2.718280076980591 } } ]\n        }\n      }\n    }\n')])]),s._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[s._v("1")]),n("br"),n("span",{staticClass:"line-number"},[s._v("2")]),n("br"),n("span",{staticClass:"line-number"},[s._v("3")]),n("br"),n("span",{staticClass:"line-number"},[s._v("4")]),n("br"),n("span",{staticClass:"line-number"},[s._v("5")]),n("br"),n("span",{staticClass:"line-number"},[s._v("6")]),n("br"),n("span",{staticClass:"line-number"},[s._v("7")]),n("br")])]),n("h2",{attrs:{id:"参考文章"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考文章"}},[s._v("#")]),s._v(" 参考文章")]),s._v(" "),n("ul",[n("li",[s._v("https://www.elastic.co/guide/en/elasticsearch/reference/current/search-\naggregations-metrics.html")])])])}),[],!1,null,null,null);n.default=t.exports}}]);