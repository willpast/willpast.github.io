(window.webpackJsonp=window.webpackJsonp||[]).push([[213],{544:function(e,a,s){"use strict";s.r(a);var t=s(4),r=Object(t.a)({},(function(){var e=this,a=e._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"sql语言-sql语句优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#sql语言-sql语句优化"}},[e._v("#")]),e._v(" SQL语言 - SQL语句优化")]),e._v(" "),a("blockquote",[a("p",[e._v("最后，再总结一些SQL语句的优化建议。")])]),e._v(" "),a("h2",{attrs:{id:"负向查询不能使用索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#负向查询不能使用索引"}},[e._v("#")]),e._v(" 负向查询不能使用索引")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("select name from user where id not in (1,3,4);\n")])])]),a("p",[e._v("应该修改为:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("select name from user where id in (2,5,6);\n")])])]),a("h2",{attrs:{id:"前导模糊查询不能使用索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#前导模糊查询不能使用索引"}},[e._v("#")]),e._v(" 前导模糊查询不能使用索引")]),e._v(" "),a("p",[e._v("如:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("select name from user where name like '%zhangsan'\n")])])]),a("p",[e._v("非前导则可以:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("select name from user where name like 'zhangsan%'\n")])])]),a("p",[e._v("建议可以考虑使用 "),a("code",[e._v("Lucene")]),e._v(" 等全文索引工具来代替频繁的模糊查询。")]),e._v(" "),a("h2",{attrs:{id:"数据区分不明显的不建议创建索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据区分不明显的不建议创建索引"}},[e._v("#")]),e._v(" 数据区分不明显的不建议创建索引")]),e._v(" "),a("p",[e._v("如 user 表中的性别字段，可以明显区分的才建议创建索引，如身份证等字段。")]),e._v(" "),a("h2",{attrs:{id:"字段的默认值不要为-null"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#字段的默认值不要为-null"}},[e._v("#")]),e._v(" 字段的默认值不要为 null")]),e._v(" "),a("p",[e._v("这样会带来和预期不一致的查询结果。")]),e._v(" "),a("h2",{attrs:{id:"在字段上进行计算不能命中索引"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#在字段上进行计算不能命中索引"}},[e._v("#")]),e._v(" 在字段上进行计算不能命中索引")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("select name from user where FROM_UNIXTIME(create_time) < CURDATE();\n")])])]),a("p",[e._v("应该修改为:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("select name from user where create_time < FROM_UNIXTIME(CURDATE());\n")])])]),a("h2",{attrs:{id:"最左前缀问题"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#最左前缀问题"}},[e._v("#")]),e._v(" 最左前缀问题")]),e._v(" "),a("p",[e._v("如果给 user 表中的 username pwd 字段创建了复合索引那么使用以下SQL 都是可以命中索引:")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("select username from user where username='zhangsan' and pwd ='axsedf1sd'\n\nselect username from user where pwd ='axsedf1sd' and username='zhangsan'\n\nselect username from user where username='zhangsan'\n")])])]),a("p",[e._v("但是使用")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("select username from user where pwd ='axsedf1sd'\n")])])]),a("p",[e._v("是不能命中索引的。")]),e._v(" "),a("h2",{attrs:{id:"如果明确知道只有一条记录返回"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如果明确知道只有一条记录返回"}},[e._v("#")]),e._v(" 如果明确知道只有一条记录返回")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("select name from user where username='zhangsan' limit 1\n")])])]),a("p",[e._v("可以提高效率，可以让数据库停止游标移动。")]),e._v(" "),a("h2",{attrs:{id:"不要让数据库帮我们做强制类型转换"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#不要让数据库帮我们做强制类型转换"}},[e._v("#")]),e._v(" 不要让数据库帮我们做强制类型转换")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("select name from user where telno=18722222222\n")])])]),a("p",[e._v("这样虽然可以查出数据，但是会导致全表扫描。")]),e._v(" "),a("p",[e._v("需要修改为")]),e._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[e._v("select name from user where telno='18722222222'\n")])])]),a("h2",{attrs:{id:"如果需要进行-join-的字段两表的字段类型要相同"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#如果需要进行-join-的字段两表的字段类型要相同"}},[e._v("#")]),e._v(" 如果需要进行 join 的字段两表的字段类型要相同")]),e._v(" "),a("p",[e._v("不然也不会命中索引。")]),e._v(" "),a("h1",{attrs:{id:"参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[e._v("#")]),e._v(" 参考")]),e._v(" "),a("ul",[a("li",[e._v("https://github.com/realpdai/JCSprout/blob/master/MD/SQL-optimization.md")]),e._v(" "),a("li",[e._v("http://blog.csdn.net/u010003835/article/details/54381080")]),e._v(" "),a("li",[a("a",{attrs:{href:"https://mp.weixin.qq.com/s/BMQC2oJlhLoeBDtveXgHpw",target:"_blank",rel:"noopener noreferrer"}},[e._v("MySQL 大表优化方案在新窗口打开"),a("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=r.exports}}]);